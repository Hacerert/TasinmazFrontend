<!-- Log Yönetimi - Proje Uyumlu Tasarım -->
<div class="container mx-auto p-4 bg-gray-50 min-h-screen">
  <div class="mb-4 border-b border-gray-200 pb-3">
    <div class="flex justify-between items-center">
      <h1 class="text-2xl font-bold text-gray-900">Log Kayıtları</h1>
      <div class="flex space-x-2">
        <!-- Kompakt Butonlar -->
        <button (click)="exportSelectedToExcel()" [disabled]="selectedLogIds.length === 0" class="btn btn-sm btn-orange">📊 Seçilenleri Aktar ({{selectedLogIds.length}})</button>
        <button (click)="exportToExcel(true)" class="btn btn-sm btn-green">📊 Tümünü Aktar</button>
        <button (click)="goBack()" class="btn btn-sm btn-blue">← Geri</button>
      </div>
    </div>

  <!-- Kompakt Filtre -->
  <div class="compact-filter mb-3">
    <div class="flex items-center p-3 bg-white border border-gray-200 rounded">
      <!-- Tek Satırda Tüm Filtreler -->
      <div class="flex items-center space-x-3 flex-1">
        <select [(ngModel)]="filterActionType" class="compact-select">
          <option value="">İşlem</option>
          <option *ngFor="let action of availableActionTypes" [value]="action">{{ action }}</option>
        </select>
        
        <select [(ngModel)]="filterStatus" class="compact-select">
          <option value="">Durum</option>
          <option *ngFor="let status of availableStatuses" [value]="status">{{ status }}</option>
        </select>
        
        <input [(ngModel)]="filterUserId" placeholder="Kullanıcı" class="compact-input">
        
        <button (click)="applyFilters()" class="btn btn-sm btn-blue">🔍</button>
        <button (click)="clearFilters()" class="btn btn-sm btn-gray">✕</button>
      </div>
    </div>
  </div>

    <!-- Yükleniyor Durumu -->
    <div *ngIf="isLoading" class="flex justify-center items-center h-48">
      <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"></div>
      <p class="ml-4 text-lg text-gray-600">Loglar yükleniyor...</p>
    </div>

    <!-- Hata Durumu -->
    <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
      <strong class="font-bold">Hata!</strong>
      <span class="block sm:inline ml-2">{{ error }}</span>
    </div>

    <!-- Veri Yok Durumu -->
    <div *ngIf="!isLoading && !error && filteredLogs.length === 0" class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
      <strong class="font-bold">Bilgi!</strong>
      <span class="block sm:inline ml-2">Gösterilecek log kaydı bulunamadı. Filtreleri temizleyebilir veya yeni loglar ekleyebilirsiniz.</span>
    </div>

  <!-- Premium Log Tablosu - Taşınmaz Uyumlu -->
  <div *ngIf="!isLoading && !error && filteredLogs.length > 0" class="glass-card premium-table-container overflow-hidden">
    <div class="overflow-x-auto">
      <table class="premium-table">
        <thead>
          <tr class="premium-table-header">
            <th class="px-4 py-3 text-left">
              <input type="checkbox" (change)="toggleSelectAll($event)" class="premium-checkbox">
            </th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">ID</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Kullanıcı</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Email</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Rol</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Durum</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">İşlem</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Açıklama</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Tarih</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">Saat</th>
            <th class="px-4 py-3 text-left font-semibold text-slate-800">IP</th>
          </tr>
        </thead>
        <tbody class="premium-table-body">
          <tr *ngFor="let log of paginatedLogs; let i = index" 
              [class]="i % 2 === 0 ? 'premium-table-row-even' : 'premium-table-row-odd'"
              class="premium-table-row">
            <td class="px-4 py-3">
              <input type="checkbox" 
                     [checked]="selectedLogIds.includes(log.id)" 
                     (change)="onCheckboxChange(log.id, $event)"
                     class="premium-checkbox">
            </td>
            <td class="px-4 py-3 font-medium text-slate-900">{{ log.id }}</td>
            <td class="px-4 py-3 text-slate-800">{{ log.user?.userName || 'Bilinmiyor' }}</td>
            <td class="px-4 py-3 text-slate-600">{{ log.user?.email || '-' }}</td>
            <td class="px-4 py-3">
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                    [class]="log.user?.role === 'Admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'">
                {{ log.user?.role || '-' }}
              </span>
            </td>
            <td class="px-4 py-3">
              <span [ngClass]="getStatusClass(log.status)" class="px-2.5 py-0.5 text-xs font-medium rounded-full">
                {{ log.status }}
              </span>
            </td>
            <td class="px-4 py-3">
              <span [ngClass]="getActionClass(log.actionType)" class="px-2.5 py-0.5 text-xs font-medium rounded-full">
                {{ log.actionType }}
              </span>
            </td>
            <td class="px-4 py-3 max-w-xs truncate text-slate-600">{{ log.description }}</td>
            <td class="px-4 py-3 text-slate-700 font-mono text-sm">{{ log.createdAt | date:'dd/MM/yyyy' }}</td>
            <td class="px-4 py-3 text-slate-700 font-mono text-sm">{{ log.createdAt | date:'HH:mm:ss' }}</td>
            <td class="px-4 py-3 text-slate-600 font-mono text-sm">{{ log.ipAddress }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Kompakt Pagination -->
  <div *ngIf="!isLoading && !error && filteredLogs.length > 0" class="mt-4 flex justify-between items-center text-sm">
    <div class="text-gray-700">
      {{ filteredLogs.length }} kayıttan {{ (currentPage - 1) * itemsPerPage + 1 }}-{{ Math.min(currentPage * itemsPerPage, filteredLogs.length) }} arası
    </div>
    <div class="flex space-x-1">
      <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1" class="btn btn-sm btn-gray">‹</button>
      <ng-container *ngFor="let page of getPagesArray()">
        <button (click)="goToPage(page)" [class]="page === currentPage ? 'btn btn-sm btn-blue' : 'btn btn-sm btn-gray'">{{ page }}</button>
      </ng-container>
      <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages" class="btn btn-sm btn-gray">›</button>
    </div>
  </div>
</div>

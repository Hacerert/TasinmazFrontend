<div class="min-h-screen bg-gray-100 p-4 sm:p-6 lg:p-8">
  <div class="max-w-7xl mx-auto bg-white shadow-lg rounded-xl p-6 sm:p-8">

    <!-- Başlık ve Butonlar (Küçültülmüş ve Sağ Üste Taşındı) -->
    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 border-b pb-4">
      <h1 class="text-3xl font-extrabold text-gray-900 mb-4 sm:mb-0">Log Kayıtları</h1>
      <div class="flex space-x-2">
        <button
          (click)="exportToExcel()"
          class="bg-green-600 hover:bg-green-700 text-white font-semibold py-1.5 px-3 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:scale-105 flex items-center text-sm"
        >
          <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"></path></svg>
          Excel'e Aktar
        </button>
        <button
          (click)="goBack()"
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-1.5 px-3 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:scale-105 flex items-center text-sm"
        >
          <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
          Geri Dön
        </button>
      </div>
    </div>

    <!-- Filtreleme Alanı (Çerçeveli, Yan Yana ve Kompakt) -->
    <div class="mb-6 p-4 bg-white rounded-lg shadow-md border border-gray-200"> <!-- Çerçeve eklendi -->
      <div class="flex flex-wrap items-end gap-x-4 gap-y-3"> <!-- gap-x ile yatay boşluk, gap-y ile dikey boşluk -->
        <h2 class="text-xl font-bold text-gray-800 flex-shrink-0 mr-4">Filtre:</h2>

        <!-- Durum Filtresi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]"> <!-- Esnek ve minimum/maksimum genişlikler -->
          <label for="filterStatus" class="block text-xs font-medium text-gray-600 mb-0.5">Durum</label>
          <select
            id="filterStatus"
            [(ngModel)]="filterStatus"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm bg-white"
          >
            <option value="">Seçiniz</option>
            <option *ngFor="let status of availableStatuses" [value]="status">{{ status }}</option>
          </select>
        </div>

        <!-- İşlem Türü Filtresi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]">
          <label for="filterActionType" class="block text-xs font-medium text-gray-600 mb-0.5">İşlem Türü</label>
          <select
            id="filterActionType"
            [(ngModel)]="filterActionType"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm bg-white"
          >
            <option value="">Seçiniz</option>
            <option *ngFor="let action of availableActionTypes" [value]="action">{{ action }}</option>
          </select>
        </div>

        <!-- Kullanıcı ID Filtresi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]">
          <label for="filterUserId" class="block text-xs font-medium text-gray-600 mb-0.5">Kullanıcı ID</label>
          <input
            id="filterUserId"
            type="text"
            [(ngModel)]="filterUserId"
            placeholder="Seçiniz"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm"
          />
        </div>

        <!-- IP Adresi Filtresi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]">
          <label for="filterIpAddress" class="block text-xs font-medium text-gray-600 mb-0.5">IP Adresi</label>
          <input
            id="filterIpAddress"
            type="text"
            [(ngModel)]="filterIpAddress"
            placeholder="Seçiniz"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm"
          />
        </div>

        <!-- Başlangıç Tarihi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]">
          <label for="filterStartDate" class="block text-xs font-medium text-gray-600 mb-0.5">Başlangıç Tarihi</label>
          <input
            id="filterStartDate"
            type="date"
            [(ngModel)]="filterStartDate"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm"
          />
        </div>

        <!-- Bitiş Tarihi -->
        <div class="flex-1 min-w-[120px] max-w-[180px]">
          <label for="filterEndDate" class="block text-xs font-medium text-gray-600 mb-0.5">Bitiş Tarihi</label>
          <input
            id="filterEndDate"
            type="date"
            [(ngModel)]="filterEndDate"
            class="p-2 border border-gray-300 rounded-md w-full focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm"
          />
        </div>

        <!-- Uygula ve Temizle Butonları -->
        <div class="flex-shrink-0 mt-auto flex space-x-2">
          <button
            (click)="applyFilters()"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center text-sm"
          >
            Uygula
          </button>
          <button
            (click)="clearFilters()"
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center text-sm"
          >
            Temizle
          </button>
        </div>
      </div>
    </div>

    <!-- Yükleniyor Durumu -->
    <div *ngIf="isLoading" class="flex justify-center items-center h-48">
      <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500"></div>
      <p class="ml-4 text-lg text-gray-600">Loglar yükleniyor...</p>
    </div>

    <!-- Hata Durumu -->
    <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
      <strong class="font-bold">Hata!</strong>
      <span class="block sm:inline ml-2">{{ error }}</span>
    </div>

    <!-- Veri Yok Durumu -->
    <div *ngIf="!isLoading && !error && filteredLogs.length === 0" class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded-lg relative mb-6" role="alert">
      <strong class="font-bold">Bilgi!</strong>
      <span class="block sm:inline ml-2">Gösterilecek log kaydı bulunamadı. Filtreleri temizleyebilir veya yeni loglar ekleyebilirsiniz.</span>
    </div>

    <!-- Log Tablosu -->
    <div *ngIf="!isLoading && !error && filteredLogs.length > 0" class="overflow-x-auto rounded-lg shadow-md">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kullanıcı Adı</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Durum</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">İşlem Türü</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Açıklama</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tarih</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Saat</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP Adresi</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let log of filteredLogs" class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ log.id }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.user?.userName || 'Bilinmiyor' }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.user?.email || '-' }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.user?.role || '-' }}</td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span [ngClass]="getStatusClass(log.status)" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                {{ log.status }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span [ngClass]="getActionClass(log.actionType)" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                {{ log.actionType }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-normal text-sm text-gray-800 max-w-xs overflow-hidden text-ellipsis">{{ log.description }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.createdAt | date:'dd/MM/yyyy' }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.createdAt | date:'HH:mm:ss' }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{{ log.ipAddress }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
